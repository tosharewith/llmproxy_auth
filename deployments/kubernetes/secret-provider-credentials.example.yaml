apiVersion: v1
kind: Secret
metadata:
  name: ai-gateway-provider-credentials
  namespace: bedrock-system
  labels:
    app: ai-gateway
    component: credentials
type: Opaque
stringData:
  # ==========================================
  # OpenAI Credentials
  # ==========================================
  # Get your API key from: https://platform.openai.com/api-keys
  OPENAI_API_KEY: "sk-EXAMPLE_REPLACE_WITH_YOUR_ACTUAL_KEY"
  OPENAI_BASE_URL: "https://api.openai.com/v1"

  # ==========================================
  # Anthropic Credentials
  # ==========================================
  # Get your API key from: https://console.anthropic.com/settings/keys
  ANTHROPIC_API_KEY: "sk-ant-EXAMPLE_REPLACE_WITH_YOUR_ACTUAL_KEY"
  ANTHROPIC_BASE_URL: "https://api.anthropic.com/v1"

  # ==========================================
  # Azure OpenAI Credentials
  # ==========================================
  # Get from Azure Portal → Your OpenAI Resource → Keys and Endpoint
  AZURE_OPENAI_ENDPOINT: "https://your-resource.openai.azure.com"
  AZURE_OPENAI_API_KEY: "EXAMPLE_REPLACE_WITH_YOUR_ACTUAL_KEY"
  AZURE_API_VERSION: "2024-02-15-preview"

  # ==========================================
  # Google Vertex AI / Gemini Credentials
  # ==========================================
  # Option 1: Use service account key
  # Create at: https://console.cloud.google.com/iam-admin/serviceaccounts
  GCP_PROJECT_ID: "your-project-id"
  GCP_LOCATION: "us-central1"
  GCP_ACCESS_TOKEN: "EXAMPLE_REPLACE_WITH_YOUR_ACTUAL_TOKEN"

  # Option 2: Use Workload Identity (recommended for GKE)
  # Set up: https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity
  # No token needed - uses workload identity

  # ==========================================
  # IBM watsonx.ai Credentials
  # ==========================================
  # Get from: https://cloud.ibm.com/iam/apikeys
  IBM_API_KEY: "EXAMPLE_REPLACE_WITH_YOUR_ACTUAL_KEY"
  IBM_PROJECT_ID: "your-project-id"
  IBM_BASE_URL: "https://us-south.ml.cloud.ibm.com"

  # ==========================================
  # Oracle Cloud AI Credentials
  # ==========================================
  # Get from Oracle Cloud Console
  ORACLE_ENDPOINT: "https://inference.generativeai.us-chicago-1.oci.oraclecloud.com"
  ORACLE_AUTH_TOKEN: "EXAMPLE_REPLACE_WITH_YOUR_ACTUAL_TOKEN"
  ORACLE_COMPARTMENT_ID: "ocid1.compartment.oc1..example"

---
# IMPORTANT: Creating the actual secret
#
# Option 1: Create from file (RECOMMENDED)
# =========================================
# 1. Copy this file and remove '.example.yaml' extension
# 2. Replace all EXAMPLE values with your actual credentials
# 3. Apply: kubectl apply -f secret-provider-credentials.yaml
# 4. DELETE the file with real credentials (don't commit to git!)
#
# Option 2: Create from command line
# ===================================
# kubectl create secret generic ai-gateway-provider-credentials \
#   --namespace=bedrock-system \
#   --from-literal=OPENAI_API_KEY='sk-...' \
#   --from-literal=ANTHROPIC_API_KEY='sk-ant-...' \
#   --from-literal=AZURE_OPENAI_ENDPOINT='https://...' \
#   --from-literal=AZURE_OPENAI_API_KEY='...' \
#   --from-literal=GCP_PROJECT_ID='your-project-id' \
#   --from-literal=GCP_ACCESS_TOKEN='...'
#
# Option 3: Use External Secrets Operator (PRODUCTION RECOMMENDED)
# =================================================================
# Use AWS Secrets Manager, HashiCorp Vault, or similar
# See: https://external-secrets.io/

---
# ExternalSecret example using AWS Secrets Manager
# Requires: External Secrets Operator installed
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: ai-gateway-provider-credentials
  namespace: bedrock-system
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-secrets-manager
    kind: SecretStore
  target:
    name: ai-gateway-provider-credentials
    creationPolicy: Owner
  dataFrom:
    - extract:
        key: /ai-gateway/provider-credentials  # Path in AWS Secrets Manager

---
# ExternalSecret example using HashiCorp Vault
# Requires: External Secrets Operator installed
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: ai-gateway-provider-credentials
  namespace: bedrock-system
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-backend
    kind: SecretStore
  target:
    name: ai-gateway-provider-credentials
    creationPolicy: Owner
  data:
    - secretKey: OPENAI_API_KEY
      remoteRef:
        key: secret/ai-gateway/openai
        property: api_key
    - secretKey: ANTHROPIC_API_KEY
      remoteRef:
        key: secret/ai-gateway/anthropic
        property: api_key
    - secretKey: AZURE_OPENAI_API_KEY
      remoteRef:
        key: secret/ai-gateway/azure
        property: api_key

---
# SECURITY NOTES:
#
# 1. AWS Bedrock (RECOMMENDED APPROACH):
#    - Use IAM Roles for Service Accounts (IRSA)
#    - No API keys needed in secrets
#    - Automatic credential rotation
#    - See: serviceaccount.yaml for IRSA configuration
#
# 2. Never commit secrets to version control:
#    - Always use .gitignore for secret files
#    - Use example files with placeholder values
#    - Store real secrets in AWS Secrets Manager, Vault, etc.
#
# 3. Secret rotation:
#    - Rotate API keys regularly (every 90 days)
#    - Use External Secrets Operator for automatic rotation
#    - Monitor for exposed credentials using tools like gitleaks
#
# 4. Least privilege:
#    - Each provider should have minimal required permissions
#    - Use separate credentials per environment
#    - Audit credential usage regularly
#
# 5. Encryption at rest:
#    - Enable encryption for Kubernetes Secrets
#    - Use encrypted storage backend (etcd encryption)
#    - Consider using sealed-secrets or sops
